<!DOCTYPE html>
<html lang="en">
<head>
	
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>War Zone Tracker</title>
	
	<script src="./assets/js/jquery-1.10.2.js"></script>
	<link rel="stylesheet" href="./assets/lib/jquery-ui.css">
    <script src="./assets/lib/jquery-ui.js"></script>
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<script src="./assets/lib/bootstrap.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Cinzel' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
	
	<script type="text/javascript" src="./assets/lib/glMatrix-0.9.5.min.js"></script>
	<script type="text/javascript" src="./assets/lib/webgl-utils.js"></script>
	
	<link rel="stylesheet" href="./assets/css/main.css">
	
    <link rel="stylesheet" href="webgl.css" type="text/css">
    <!--<script src="./assets/webgl/sylvester.js" type="text/javascript"></script>
    <script src="./assets/webgl/glUtils.js" type="text/javascript"></script>-->
	<script src="./assets/js/Shader.js" type="text/javascript"></script>
	<script src="./assets/js/GraphicsObject.js" type="text/javascript"></script>
	<script src="./assets/js/OBJ.js" type="text/javascript"></script>
	<script src="./assets/js/Gallery.js" type="text/javascript"></script>
	<script src="./assets/js/Room.js" type="text/javascript"></script>
	<script src="./assets/js/Sphere.js" type="text/javascript"></script>
	<script src="./assets/js/Rectangle.js" type="text/javascript"></script>
	<script src="./assets/js/War.js" type="text/javascript"></script>
	<script src="./assets/js/Battle.js" type="text/javascript"></script>
	<script src="./assets/js/User.js" type="text/javascript"></script>
	<script src="./assets/js/config.js" type="text/javascript"></script>
	<script src="./assets/js/Initialize.js" type="text/javascript"></script>
	<script src="./assets/js/KeyPressManager.js" type="text/javascript"></script> 
    <script src="webgl-demo.js" type="text/javascript"></script>

<script id="per-fragment-lighting-fs" type="x-shader/x-fragment">
    precision highp float; 

    varying highp vec2 vTextureCoord;
    varying highp vec3 vTransformedNormal;
    varying highp vec4 vPosition;

    uniform highp vec3 uMaterialAmbientColor;
    uniform highp vec3 uMaterialDiffuseColor;
    uniform highp vec3 uMaterialSpecularColor;
    uniform float uMaterialShininess;
    uniform highp vec3 uMaterialEmissiveColor;

    uniform bool uShowSpecularHighlights;
    uniform bool uUseTextures;
	uniform bool uClickSampler;
	uniform bool uGlow;

    uniform highp vec3 uAmbientLightingColor;

    uniform highp vec3 uPointLightingLocation;
    uniform highp vec3 uPointLightingDiffuseColor;
    uniform highp vec3 uPointLightingSpecularColor;
	uniform vec3 uClickableObject;

    uniform highp sampler2D uSampler;


    void main(void) {
        vec3 ambientLightWeighting = uAmbientLightingColor;

        vec3 lightDirection = normalize(uPointLightingLocation - vPosition.xyz);
        vec3 normal = normalize(vTransformedNormal);

        vec3 specularLightWeighting = vec3(0.0, 0.0, 0.0);
		
        if (uShowSpecularHighlights) {
            vec3 eyeDirection = normalize(-vPosition.xyz);
            vec3 reflectionDirection = reflect(-lightDirection, normal);

            float specularLightBrightness = pow(abs(dot(reflectionDirection, eyeDirection)), uMaterialShininess);
            specularLightWeighting = uPointLightingSpecularColor * specularLightBrightness;
        }

        float diffuseLightBrightness = max(dot(normal, lightDirection), 0.0);
        vec3 diffuseLightWeighting = uPointLightingDiffuseColor * diffuseLightBrightness;

        vec3 materialAmbientColor = uMaterialAmbientColor;
        vec3 materialDiffuseColor = uMaterialDiffuseColor;
        vec3 materialSpecularColor = uMaterialSpecularColor;
        vec3 materialEmissiveColor = uMaterialEmissiveColor;
        float alpha = 1.0;
        if (uUseTextures) {
			highp float glow_offset = 0.01;
			vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t)); 
			
			if(uGlow){			
				vec4 textureColor_p_0 = texture2D(uSampler, vec2(vTextureCoord.s+glow_offset, vTextureCoord.t)); 
				vec4 textureColor_n_0 = texture2D(uSampler, vec2(vTextureCoord.s-glow_offset, vTextureCoord.t)); 
				vec4 textureColor_0_p = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t+glow_offset)); 
				vec4 textureColor_0_n = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t-glow_offset)); 
				vec4 textureColor_p_p = texture2D(uSampler, vec2(vTextureCoord.s+glow_offset, vTextureCoord.t+glow_offset)); 
				vec4 textureColor_p_n = texture2D(uSampler, vec2(vTextureCoord.s+glow_offset, vTextureCoord.t-glow_offset)); 
				vec4 textureColor_n_p = texture2D(uSampler, vec2(vTextureCoord.s-glow_offset, vTextureCoord.t+glow_offset)); 
				vec4 textureColor_n_n = texture2D(uSampler, vec2(vTextureCoord.s-glow_offset, vTextureCoord.t-glow_offset)); 
				vec4 textureColorGlow = vec4( (textureColor.r * 0.2)+(textureColor_p_0.r+textureColor_n_0.r+textureColor_0_p.r+textureColor_0_n.r+textureColor_p_p.r+textureColor_n_p.r+textureColor_n_p.r+textureColor_n_n.r) * 0.1, 
											  (textureColor.g * 0.2)+(textureColor_p_0.g+textureColor_n_0.g+textureColor_0_p.g+textureColor_0_n.g+textureColor_p_p.g+textureColor_n_p.g+textureColor_n_p.g+textureColor_n_n.g) * 0.1,
											  (textureColor.b * 0.2)+(textureColor_p_0.b+textureColor_n_0.b+textureColor_0_p.b+textureColor_0_n.b+textureColor_p_p.b+textureColor_n_p.b+textureColor_n_p.b+textureColor_n_n.b) * 0.1,
											  (textureColor.a * 0.2)+(textureColor_p_0.a+textureColor_n_0.a+textureColor_0_p.a+textureColor_0_n.a+textureColor_p_p.a+textureColor_n_p.a+textureColor_n_p.a+textureColor_n_n.a) * 0.1);
			
				materialAmbientColor  = materialAmbientColor  * textureColorGlow.rgb;
				materialDiffuseColor  = materialDiffuseColor  * textureColorGlow.rgb;
				materialEmissiveColor = materialEmissiveColor * textureColorGlow.rgb;
														alpha = textureColorGlow.a;
			}
			else{
				materialAmbientColor  = materialAmbientColor  * textureColor.rgb;
				materialDiffuseColor  = materialDiffuseColor  * textureColor.rgb;
				materialEmissiveColor = materialEmissiveColor * textureColor.rgb;
														alpha = textureColor.a;
			}
        }
		
		if(uClickableObject == vec3(0,0,0) || !uClickSampler){
			gl_FragColor = vec4(
				materialAmbientColor * ambientLightWeighting
				+ materialDiffuseColor * diffuseLightWeighting
				+ materialSpecularColor * specularLightWeighting //Definite cause of lighting problem
				+ materialEmissiveColor
				,
				alpha
			);
		}
		else{
			gl_FragColor = vec4(uClickableObject, 1.0);
		}
    }
</script>

<script id="per-fragment-lighting-vs" type="x-shader/x-vertex">
	precision highp float; 

    attribute vec3 aVertexPosition;
    attribute vec3 aVertexNormal;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    uniform mat3 uNMatrix;
	uniform vec3 uScale;

    varying highp vec2 vTextureCoord;
    varying highp vec3 vTransformedNormal;
    varying highp vec4 vPosition;

    void main(void) {
        vPosition = uMVMatrix * vec4(aVertexPosition*uScale, 1.0);
        gl_Position = uPMatrix * vPosition;
        vTextureCoord = aTextureCoord;
        vTransformedNormal = uNMatrix * aVertexNormal;
    }
</script>
	
</head>
<body onload="start();">

	<nav id="top-panel" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
				<a id="war-name" class="navbar-brand" data-toggle="modal" data-target="#wars-modal"></a>
            </div>
            <div class="collapse navbar-collapse pull-right" id="navbar-collapse-1">
			
                <ul class="nav navbar-nav text-center" style="width:100%;">
					<li>
						<a data-toggle="modal" data-target="#battles-modal">
							Battles
						</a>
                    </li>
					<li>
						<a data-toggle="modal" data-target="#countries-modal">
							Countries
						</a>
                    </li>
					<li>
						<a data-toggle="modal" data-target="#commanders-modal">
							Commanders
						</a>
                    </li>
					<li>
						<a data-toggle="modal" data-target="#settings-modal">
							<i class="glyphicon glyphicon-cog"></i>
						</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
	
	<div id="battle-info">
		<nav id="battle-top-panel" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<table>
						<tr>
							<td id="battle-start-date" class="hidden-sm hidden-xs">Apr 4, 1862</td>
							<td id="battle-name">Battle of Gettysburg</td>
							<td id="battle-end-date" class="hidden-sm hidden-xs">Apr 16, 1862</td>
						</tr>
					</table>
				</div>
			</div>
		</nav>
		
		<div class="hidden-xs hidden-sm">
		
			<nav id="battle-bottom-panel" class="navbar navbar-inverse navbar-fixed-bottom" role="navigation">
				<div class="container">
					<div class="navbar-header">
						<a id="battle-location" class="navbar-brand">Gettysburg, Pennsylvania</a>
					</div>
				</div>
			</nav>
		
			<div id="left-battle-panel">
				<div class="left-flag battle-panel-flag"><img src=""/></div>
				<div id="left-country" class="battle-panel-country col-xs-12">United States</div>
				<div id="left-leader" class="col-xs-12">Ulysses S. Grant</div>
				<div class="col-xs-6"><strong>Troops</strong></div><div id="left-troops" class="col-xs-6">15000</div>
				<div class="col-xs-6"><strong>Casualities</strong></div><div id="left-casualities" class="col-xs-6">5</div>
				<div id="left-result"><span class="victory">Victory</span></div>
			</div>
			
			<div id="right-battle-panel">
				<div class="right-flag battle-panel-flag"><img src=""/></div>
				<div id="right-country" class="battle-panel-country col-xs-12">Confederate States</div>
				<div id="right-leader" class="col-xs-12">Robert E. Lee</div>
				<div class="col-xs-6"><strong>Troops</strong></div><div id="right-troops" class="col-xs-6">13000</div>
				<div class="col-xs-6"><strong>Casualities</strong></div><div id="right-casualities" class="col-xs-6">65</div>
				<div id="right-result"><span class="defeat">Defeat</span></div>
			</div>
		</div>
	</div>
	
	<canvas id="glcanvas" width="2048" height="1024" oncontextmenu="return false;">
      Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
    </canvas>

	<nav id="bottom-panel" class="navbar navbar-inverse navbar-fixed-bottom" role="navigation">
        <div class="container hidden-xs hidden-sm">
			<ul class="nav navbar-nav text-center" style="width:100%;">
				<li style="width:100%;">
					<a>
							<div class="col-md-3 col-xs-12">
								<input type="text" id="time-select-display" readonly style="border:0; color:#7E755C; font-weight:bold;width:100%;">
							</div>
							<div class="col-md-9 col-xs-12">
								<div id="time-select-slider"></div>
							</div>
					</a>
				</li>
			</ul>
        </div>
		<div class="container hidden-md hidden-lg container-sm">
			<table style="width:100%;">
				<tr>
					<td style="width:100px;">
						<span class="left-flag  battle-panel-flag-sm"><img/></span>
					</td>
					<td style="width:30px;">
						<span class="left-result-sm  battle-panel-result-sm"></span>
					</td>
					<td id="bottom-panel-sm-info-icon" style="display:none;">
						<span class="fa fa-info-circle" data-toggle="modal" data-target="#battle-info-modal"></span>
					</td>
					<td style="width:30px;">
						<span class="right-result-sm battle-panel-result-sm"></span>
					</td>
					<td style="width:100px;">
						<span class="right-flag battle-panel-flag-sm pull-right"><img/></span>
					</td>
				</tr>
			</table>
		</div>
    </nav>
	
	<div class="modal fade" id="wars-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Wars</h4>
		  </div>
		  <div class="modal-body">
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="battles-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Battles</h4>
		  </div>
		  <div class="ui-widget">
			<input id="battles-search" placeholder="Search...">
  		  </div>
		  <div class="modal-body">
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="countries-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Countries</h4>
		  </div>
		  <div class="modal-body">
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="countries-battles-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Country</h4>
		  </div>
		  <div class="modal-body">
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="commanders-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Commanders</h4>
		  </div>
		  <div class="modal-body">
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="commanders-battles-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Commander</h4>
		  </div>
		  <div class="modal-body">
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="settings-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Settings</h4>
		  </div>
		  <div class="modal-body">
			<span class="col-xs-12">
				<div class="col-xs-12 modal-select">
					<div class="col-xs-12 modal-select-title">Battle Scale <span id="battle-scale-value">100%</span></div>
					<div class="col-md-6 col-xs-12" onclick="WARS.functions.increment_battle_scale(-0.5);">
						<button class="btn btn-xs btn-setting glyphicon glyphicon-minus"></button>
					</div>
					<div class="col-md-6 col-xs-12" onclick="WARS.functions.increment_battle_scale(0.5);">
						<button class="btn btn-xs btn-setting glyphicon glyphicon-plus"></button>
					</div>
				</div>
			</span>
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>
	
	<div class="modal fade" id="battle-info-modal" role="dialog">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-header">
			<h4 class="modal-title" id="myModalLabel">Battle Info</h4>
		  </div>
		  <div class="modal-body">
			<div class="col-xs-12 modal-select country-1">
				<div class="col-xs-12 modal-select-title">
					<img> 
					<span class="country-name"></span>
					<img>
				</div>
				<div class="col-xs-12 modal-select-title country-result"></div>
				<div class="col-xs-12">Leader: <span class="country-leader"></span></div>
				<div class="col-xs-12">Troops: <span class="country-troops"></span></div>
				<div class="col-xs-12">Casualities: <span class="country-casualities"></span></div>
			</div>
			<div class="col-xs-12 modal-select country-2">
				<div class="col-xs-12 modal-select-title">
					<img> 
					<span class="country-name"></span>
					<img>
				</div>
				<div class="col-xs-12 modal-select-title country-result"></div>
				<div class="col-xs-12">Leader: <span class="country-leader"></span></div>
				<div class="col-xs-12">Troops: <span class="country-troops"></span></div>
				<div class="col-xs-12">Casualities: <span class="country-casualities"></span></div>
			</div>
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-battle-modal" data-dismiss="modal">Close</button>
		  </div>
		</div>
	  </div>
	</div>

<script>

$.ajaxSetup({async:false});

WARS.functions.init_data();

$.ajaxSetup({async:true});

</script>
</body>
</html>